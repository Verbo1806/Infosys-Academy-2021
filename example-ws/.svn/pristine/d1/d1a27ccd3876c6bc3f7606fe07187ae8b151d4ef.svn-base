package bg.infosys.crc.admin.controller;

import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import bg.infosys.common.ws.security.AuthRefreshTokenDTO;
import bg.infosys.common.ws.security.AuthRequestDTO;
import bg.infosys.common.ws.security.ChangePasswordDTO;
import bg.infosys.common.ws.security.components.AuthService;
import bg.infosys.crc.admin.config.ControllerConfig;
import bg.infosys.crc.admin.controller.docs.IAuthController;
import lombok.RequiredArgsConstructor;

@RestController
@RequiredArgsConstructor
@RequestMapping(ControllerConfig.AUTHENTICATION_URL)
public class AuthController implements IAuthController {
	private final AuthService authService;
	
	@PostMapping(value = "/o/login")
	public AuthRefreshTokenDTO login(@RequestBody AuthRequestDTO authRequest) {
		return authService.doLogin(authRequest);
	}
	
	@PostMapping(value = "/o/refresh")
	public AuthRefreshTokenDTO refresh(@RequestBody AuthRefreshTokenDTO refreshRequest) {
		return authService.doRefresh(refreshRequest);
	}
	
	@PostMapping(value = "/logout")
	public void logout() {
		authService.doLogout();
	}
	
	@PostMapping(value = "/change-password")
	public void changePassword(@RequestBody ChangePasswordDTO data) {
		authService.changePassword(data);
	}
}
